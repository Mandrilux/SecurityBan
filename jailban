#!/usr/bin/env python3
# -*- coding: latin-1 -*-

import os

class Jail:
    def __init__(self, name, files):
         self.name = name
         self.files = []
         self.sizes = []
         self.new_sizes = []
         self.fd = []

    def openFiles(self):
        for i in range(0, len(self.files)):
            try:
                fd_ssh = open(files[i],"r")
                self.fd.push(fd_ssh)
            except IOError:
                print ("Could not open file! please verify file configuration")
                self.fd.push(None)

    def getSize(self):


def detectFlag(s, key):
    if s.find(key) == -1:
        return 0
    else:
        return 1

def openFile(file):
    try:
        fd_ssh = open(file,"r")
        return fd_ssh;
    except IOError:
        print ("Could not open file! please verify file configuration")
        return None;

def ClearTab(lines):
    for i in range(0, len(lines)):
        lines[i] = lines[i].rstrip()
    return (lines)

if __name__ == '__main__':
    print ("Security Project")
    ssh_log = "/var/log/auth.log"
    print ("[%s]" % ssh_log)
    size = os.stat(ssh_log).st_size
    #print (size)
    while True:
        new_size = os.stat(ssh_log).st_size
        if new_size != size:
            print ("fichier modifier")
            fd = openFile(ssh_log)
            if fd is not None:
                print ("le fichier est ouvert")
                #print (size)
                fd.seek(size, 0)
                lines = ClearTab(fd.readlines())
                print (lines)
            size = new_size
